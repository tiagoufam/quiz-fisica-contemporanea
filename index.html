<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Quiz Educacional - GitHub Integrado</title>
  <meta name="description" content="Quiz educacional com armazenamento autom√°tico no GitHub e dashboard em tempo real." />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 128 128'><text y='1em' font-size='96'>üéì</text></svg>">
  
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <style>
    :root {
      /* Cores Base */
      --bg-primary: #f8fafc;
      --bg-secondary: #f1f5f9;
      --bg-card: #ffffff;
      
      /* Cores de Texto */
      --text-primary: #334155;
      --text-secondary: #64748b;
      --text-muted: #94a3b8;
      
      /* Cores de Destaque */
      --color-primary: #3b82f6;
      --color-primary-light: #bfdbfe;
      --color-secondary: #10b981;
      --color-secondary-light: #bbf7d0;
      
      /* Cores de Estado */
      --color-success: #16a34a;
      --color-success-light: #dcfce7;
      --color-warning: #d97706;
      --color-warning-light: #fef3c7;
      --color-error: #dc2626;
      --color-error-light: #fecaca;
      
      /* Cores Especiais */
      --color-purple: #8b5cf6;
      --color-purple-light: #e9d5ff;
      --color-pink-light: #fce7f3;
      --color-orange-light: #fed7aa;
      
      /* Bordas e Sombras */
      --border-color: #e2e8f0;
      --border-focus: #3b82f6;
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      
      /* Gradientes */
      --gradient-primary: linear-gradient(135deg, #bfdbfe 0%, #e9d5ff 100%);
      --gradient-success: linear-gradient(135deg, #bbf7d0 0%, #dcfce7 100%);
      --gradient-warning: linear-gradient(135deg, #fef3c7 0%, #fed7aa 100%);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html, body {
      height: 100%;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    body {
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.6;
      padding: 1rem;
      min-height: 100vh;
    }

    .app {
      max-width: 1200px;
      margin: 0 auto;
      width: 100%;
    }

    /* Cards e Containers */
    .card {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 1.5rem;
      box-shadow: var(--shadow-md);
      margin-bottom: 1rem;
      transition: all 0.3s ease;
    }

    .card:hover {
      box-shadow: var(--shadow-lg);
      transform: translateY(-2px);
    }

    .card-gradient {
      background: var(--gradient-primary);
      border: none;
    }

    /* Typography */
    h1 {
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 0.5rem;
      background: linear-gradient(135deg, var(--color-primary), var(--color-purple));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    h2 {
      font-size: 1.875rem;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 1rem;
    }

    h3 {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 0.75rem;
    }

    .text-muted {
      color: var(--text-muted);
      font-size: 0.875rem;
    }

    .text-secondary {
      color: var(--text-secondary);
    }

    /* Layout */
    .grid {
      display: grid;
      gap: 1rem;
    }

    .grid-2 {
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    }

    .grid-3 {
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    }

    .flex {
      display: flex;
      gap: 1rem;
    }

    .flex-center {
      align-items: center;
      justify-content: center;
    }

    .flex-between {
      align-items: center;
      justify-content: space-between;
    }

    .flex-wrap {
      flex-wrap: wrap;
    }

    /* Bot√µes */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 12px;
      font-weight: 500;
      font-size: 0.875rem;
      cursor: pointer;
      transition: all 0.2s ease;
      text-decoration: none;
      min-height: 44px;
      position: relative;
      overflow: hidden;
    }

    .btn:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow-md);
    }

    .btn:active {
      transform: translateY(0);
    }

    .btn-primary {
      background: var(--color-primary);
      color: white;
    }

    .btn-primary:hover {
      background: #2563eb;
    }

    .btn-secondary {
      background: var(--bg-secondary);
      color: var(--text-primary);
      border: 1px solid var(--border-color);
    }

    .btn-secondary:hover {
      background: #e2e8f0;
    }

    .btn-success {
      background: var(--color-success);
      color: white;
    }

    .btn-success:hover {
      background: #15803d;
    }

    .btn-warning {
      background: var(--color-warning);
      color: white;
    }

    .btn-warning:hover {
      background: #b45309;
    }

    .btn-error {
      background: var(--color-error);
      color: white;
    }

    .btn-error:hover {
      background: #b91c1c;
    }

    .btn-lg {
      padding: 1rem 2rem;
      font-size: 1rem;
      min-height: 52px;
    }

    .btn-sm {
      padding: 0.5rem 1rem;
      font-size: 0.75rem;
      min-height: 36px;
    }

    /* Inputs */
    .input {
      width: 100%;
      padding: 0.75rem 1rem;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      background: var(--bg-card);
      color: var(--text-primary);
      font-size: 0.875rem;
      transition: all 0.2s ease;
    }

    .input:focus {
      outline: none;
      border-color: var(--border-focus);
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }

    .input-group {
      margin-bottom: 1rem;
    }

    .label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
      color: var(--text-primary);
    }

    /* Pills e Badges */
    .pill {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1rem;
      background: var(--color-primary-light);
      color: var(--color-primary);
      border-radius: 999px;
      font-size: 0.75rem;
      font-weight: 500;
      border: 1px solid rgba(59, 130, 246, 0.2);
    }

    .pill-success {
      background: var(--color-success-light);
      color: var(--color-success);
      border-color: rgba(22, 163, 74, 0.2);
    }

    .pill-warning {
      background: var(--color-warning-light);
      color: var(--color-warning);
      border-color: rgba(217, 119, 6, 0.2);
    }

    /* Progress Bar */
    .progress {
      width: 100%;
      height: 8px;
      background: var(--bg-secondary);
      border-radius: 999px;
      overflow: hidden;
      position: relative;
    }

    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, var(--color-primary), var(--color-purple));
      border-radius: 999px;
      transition: width 0.3s ease;
      position: relative;
    }

    .progress-bar::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      animation: shimmer 2s infinite;
    }

    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }

    /* QR Code Container */
    .qr-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 1.5rem;
      background: var(--gradient-primary);
      border-radius: 16px;
      border: 2px dashed var(--color-primary);
    }

    .qr-code {
      background: white;
      padding: 1rem;
      border-radius: 12px;
      box-shadow: var(--shadow-md);
      min-height: 200px;
      min-width: 200px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* Quiz Options */
    .quiz-option {
      padding: 1rem 1.5rem;
      border: 2px solid var(--border-color);
      border-radius: 12px;
      background: var(--bg-card);
      cursor: pointer;
      transition: all 0.2s ease;
      margin-bottom: 0.75rem;
      position: relative;
      overflow: hidden;
    }

    .quiz-option:hover {
      border-color: var(--color-primary);
      background: var(--color-primary-light);
      transform: translateX(4px);
    }

    .quiz-option.correct {
      border-color: var(--color-success);
      background: var(--color-success-light);
      color: var(--color-success);
    }

    .quiz-option.incorrect {
      border-color: var(--color-error);
      background: var(--color-error-light);
      color: var(--color-error);
    }

    .quiz-option.selected {
      border-color: var(--color-primary);
      background: var(--color-primary-light);
      color: var(--color-primary);
    }

    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translateX(-20px); }
      to { opacity: 1; transform: translateX(0); }
    }

    .fade-in {
      animation: fadeIn 0.5s ease-out;
    }

    .slide-in {
      animation: slideIn 0.3s ease-out;
    }

    /* Loading Spinner */
    .spinner {
      width: 20px;
      height: 20px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-top: 2px solid white;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Status Indicators */
    .status-online {
      color: var(--color-success);
    }

    .status-offline {
      color: var(--color-error);
    }

    .status-loading {
      color: var(--color-warning);
    }

    /* Table */
    .table {
      width: 100%;
      border-collapse: collapse;
      background: var(--bg-card);
      border-radius: 12px;
      overflow: hidden;
      box-shadow: var(--shadow-sm);
    }

    .table th,
    .table td {
      padding: 1rem;
      text-align: left;
      border-bottom: 1px solid var(--border-color);
    }

    .table th {
      background: var(--bg-secondary);
      font-weight: 600;
      color: var(--text-primary);
    }

    .table tr:hover {
      background: var(--bg-secondary);
    }

    /* Responsive */
    @media (max-width: 768px) {
      .app {
        padding: 0.5rem;
      }
      
      .card {
        padding: 1rem;
      }
      
      h1 {
        font-size: 2rem;
      }
      
      .grid-2,
      .grid-3 {
        grid-template-columns: 1fr;
      }
      
      .flex {
        flex-direction: column;
      }
      
      .btn {
        width: 100%;
      }
    }

    /* Utility Classes */
    .hidden {
      display: none !important;
    }

    .text-center {
      text-align: center;
    }

    .mb-1 { margin-bottom: 0.25rem; }
    .mb-2 { margin-bottom: 0.5rem; }
    .mb-3 { margin-bottom: 0.75rem; }
    .mb-4 { margin-bottom: 1rem; }
    .mb-6 { margin-bottom: 1.5rem; }

    .mt-1 { margin-top: 0.25rem; }
    .mt-2 { margin-top: 0.5rem; }
    .mt-3 { margin-top: 0.75rem; }
    .mt-4 { margin-top: 1rem; }
    .mt-6 { margin-top: 1.5rem; }

    .p-4 { padding: 1rem; }
    .p-6 { padding: 1.5rem; }

    .w-full { width: 100%; }
    .h-full { height: 100%; }
  </style>
</head>
<body>
  <div class="app">
    <!-- CONFIGURA√á√ÉO INICIAL -->
    <div id="config" class="fade-in">
      <div class="card card-gradient">
        <h1>üéì Quiz Educacional - GitHub Integrado</h1>
        <p class="text-secondary mb-4">
          Configure sua integra√ß√£o com GitHub para armazenamento autom√°tico dos resultados.
        </p>
        
        <div class="pill mb-4">
          üîó Conectado ao GitHub ‚Ä¢ üìä Dados em Tempo Real ‚Ä¢ üÜì Gratuito
        </div>
      </div>

      <div class="card">
        <h3>‚öôÔ∏è Configura√ß√£o do Reposit√≥rio GitHub</h3>
        <p class="text-secondary mb-4">
          Para que os resultados sejam salvos automaticamente, configure os dados do seu reposit√≥rio GitHub:
        </p>

        <div class="grid grid-2">
          <div class="input-group">
            <label class="label" for="githubUser">
              üë§ Usu√°rio GitHub
            </label>
            <input 
              id="githubUser" 
              class="input" 
              placeholder="Ex.: prof-joao-silva" 
              value=""
            />
          </div>

          <div class="input-group">
            <label class="label" for="githubRepo">
              üìÅ Nome do Reposit√≥rio
            </label>
            <input 
              id="githubRepo" 
              class="input" 
              placeholder="Ex.: quiz-fisica-moderna" 
              value=""
            />
          </div>
        </div>

        <div class="input-group">
          <label class="label" for="githubToken">
            üîë Token de Acesso (Opcional - para escrita autom√°tica)
          </label>
          <input 
            id="githubToken" 
            class="input" 
            type="password"
            placeholder="ghp_xxxxxxxxxxxxxxxxxxxx (deixe vazio para modo somente leitura)"
          />
          <p class="text-muted mt-1">
            üí° Sem token: alunos salvam localmente, professor coleta manualmente<br>
            üîë Com token: salvamento autom√°tico no GitHub para todos
          </p>
        </div>

        <div class="flex">
          <button class="btn btn-primary btn-lg" id="btnConfigurar">
            ‚úÖ Configurar e Continuar
          </button>
          <button class="btn btn-secondary" id="btnModoLocal">
            üíª Usar Modo Local (Sem GitHub)
          </button>
        </div>

        <div class="mt-4 p-4" style="background: var(--color-primary-light); border-radius: 8px;">
          <h4 style="color: var(--color-primary); margin-bottom: 0.5rem;">üìö Como Criar Token GitHub:</h4>
          <ol style="font-size: 0.875rem; color: var(--text-secondary);">
            <li>Acesse: GitHub ‚Üí Settings ‚Üí Developer settings ‚Üí Personal access tokens</li>
            <li>Clique em "Generate new token (classic)"</li>
            <li>Marque: "repo" (Full control of private repositories)</li>
            <li>Copie o token gerado e cole aqui</li>
          </ol>
        </div>
      </div>
    </div>

    <!-- TELA INICIAL -->
    <div id="home" class="hidden fade-in">
      <!-- Header Principal -->
      <div class="card card-gradient">
        <div class="flex flex-between flex-wrap">
          <div style="flex: 2; min-width: 300px;">
            <div class="flex flex-wrap mb-3">
              <div class="pill">üéì Quiz Educacional</div>
              <div class="pill" id="statusGitHub">
                <span class="status-loading">üîÑ</span> Verificando GitHub...
              </div>
            </div>
            <h1 id="quiz-title">Quiz de F√≠sica Moderna</h1>
            <p class="text-secondary mb-4">
              Sistema integrado com GitHub para coleta autom√°tica de resultados. 
              Alunos fazem o quiz e dados s√£o salvos automaticamente para an√°lise do professor.
            </p>
            <div class="flex flex-wrap">
              <div class="pill-success">‚úÖ Salvamento Autom√°tico</div>
              <div class="pill-success">üìä Dashboard em Tempo Real</div>
              <div class="pill-success">üì± Mobile First</div>
            </div>
          </div>
          <div style="flex: 1; min-width: 250px;">
            <div class="qr-container">
              <div id="qrLink" class="qr-code">
                <img id="qrImage" style="max-width: 180px; max-height: 180px;" />
              </div>
              <p class="text-muted text-center mt-2">
                QR Code do Quiz
              </p>
              <div class="flex mt-3">
                <button class="btn btn-secondary btn-sm" id="btnQrLink">
                  üîÑ Atualizar
                </button>
                <button class="btn btn-secondary btn-sm" id="btnCopiarLink">
                  üìã Copiar Link
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Se√ß√£o Principal -->
      <div class="grid grid-2">
        <!-- √Årea do Aluno -->
        <div class="card slide-in">
          <h3>üë®‚Äçüéì √Årea do Aluno</h3>
          <p class="text-secondary mb-4">
            Digite seu nome e fa√ßa o quiz. Seus resultados ser√£o salvos automaticamente.
          </p>
          
          <div class="input-group">
            <label class="label" for="alunoNome">
              üìù Seu nome completo
            </label>
            <input 
              id="alunoNome" 
              class="input" 
              placeholder="Ex.: Ana Silva Santos" 
              maxlength="50"
              required
            />
          </div>

          <div class="flex">
            <button class="btn btn-success btn-lg" id="btnIniciar">
              üöÄ Iniciar Quiz
            </button>
          </div>

          <div class="mt-4 p-4" style="background: var(--color-success-light); border-radius: 8px;">
            <p class="text-secondary" style="font-size: 0.875rem;">
              ‚úÖ <strong>Autom√°tico:</strong> Ao terminar o quiz, seus resultados ser√£o salvos automaticamente para o professor analisar.
            </p>
          </div>
        </div>

        <!-- √Årea do Professor -->
        <div class="card slide-in">
          <h3>üë©‚Äçüè´ √Årea do Professor</h3>
          <p class="text-secondary mb-4">
            Acesse o dashboard para ver todos os resultados coletados automaticamente.
          </p>

          <div class="grid">
            <button class="btn btn-primary btn-lg" id="btnDashboard">
              üìä Dashboard de An√°lise
            </button>
            <button class="btn btn-secondary" id="btnConfigurarRepo">
              ‚öôÔ∏è Configurar Reposit√≥rio
            </button>
            <button class="btn btn-warning" id="btnExportarDados">
              üì• Exportar Todos os Dados
            </button>
          </div>

          <div class="mt-4">
            <div class="flex flex-between">
              <span class="text-secondary">Status da Conex√£o:</span>
              <span id="connectionStatus" class="status-loading">üîÑ Verificando...</span>
            </div>
            <div class="flex flex-between mt-2">
              <span class="text-secondary">Resultados Coletados:</span>
              <span id="resultadosCount" class="font-weight-bold">-</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Instru√ß√µes -->
      <div class="card">
        <h3>üìã Como Funciona</h3>
        <div class="grid grid-3">
          <div class="p-4" style="background: var(--color-primary-light); border-radius: 8px;">
            <h4 style="color: var(--color-primary); margin-bottom: 0.5rem;">1Ô∏è‚É£ Aluno Faz Quiz</h4>
            <p class="text-secondary" style="font-size: 0.875rem;">
              Aluno acessa via QR code ou link, responde as quest√µes e finaliza automaticamente.
            </p>
          </div>
          <div class="p-4" style="background: var(--color-success-light); border-radius: 8px;">
            <h4 style="color: var(--color-success); margin-bottom: 0.5rem;">2Ô∏è‚É£ Dados Salvos</h4>
            <p class="text-secondary" style="font-size: 0.875rem;">
              Resultados s√£o salvos automaticamente no GitHub com timestamp e detalhes completos.
            </p>
          </div>
          <div class="p-4" style="background: var(--color-warning-light); border-radius: 8px;">
            <h4 style="color: var(--color-warning); margin-bottom: 0.5rem;">3Ô∏è‚É£ Professor Analisa</h4>
            <p class="text-secondary" style="font-size: 0.875rem;">
              Dashboard mostra todos os resultados em tempo real com an√°lises detalhadas.
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- TELA DO QUIZ -->
    <div id="quiz" class="hidden">
      <div class="card">
        <div class="flex flex-between flex-wrap mb-4">
          <div class="pill" id="meta">
            üìù Quest√£o <span id="qid">1</span> de <span id="qtotal">5</span>
          </div>
          <div class="flex" style="align-items: center; gap: 1rem;">
            <span class="text-muted">Progresso:</span>
            <div class="progress" style="width: 200px;">
              <div class="progress-bar" id="prog" style="width: 0%"></div>
            </div>
            <span class="text-muted" id="progText">0%</span>
          </div>
        </div>

        <div class="card" style="background: var(--gradient-primary); border: none;">
          <h2 id="qtext" class="mb-4">Carregando pergunta...</h2>
          <div id="olist" class="grid"></div>
        </div>

        <div class="flex mt-4">
          <button class="btn btn-secondary" id="btnSair">
            ‚Üê Voltar ao In√≠cio
          </button>
          <div id="autoSaveStatus" class="pill" style="margin-left: auto;">
            üíæ Salvamento autom√°tico ativo
          </div>
        </div>
      </div>
    </div>

    <!-- RESULTADO DO ALUNO -->
    <div id="resultado" class="hidden">
      <div class="card card-gradient text-center">
        <h2 class="mb-4">üéâ Quiz Conclu√≠do!</h2>
        <div id="resumo" class="mb-6"></div>
        
        <div class="card">
          <h3 class="mb-4">‚úÖ Resultado Salvo Automaticamente</h3>
          <div id="saveStatus" class="mb-4">
            <div class="flex flex-center">
              <div class="spinner"></div>
              <span class="ml-2">Salvando seus resultados...</span>
            </div>
          </div>
          
          <div class="grid grid-2">
            <button class="btn btn-success" id="btnRefazer">
              üîÑ Fazer Novamente
            </button>
            <button class="btn btn-secondary" id="btnVoltar">
              üè† Voltar ao In√≠cio
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- DASHBOARD DO PROFESSOR -->
    <div id="dashboard" class="hidden">
      <div class="card card-gradient">
        <div class="flex flex-between flex-wrap mb-4">
          <h2>üìä Dashboard de An√°lise</h2>
          <div class="flex">
            <button class="btn btn-secondary" id="btnAtualizarDados">
              üîÑ Atualizar Dados
            </button>
            <button class="btn btn-secondary" id="btnFecharDashboard">
              ‚Üê Voltar
            </button>
          </div>
        </div>
        
        <div class="pill mb-4" id="lastUpdate">
          üïí √öltima atualiza√ß√£o: Carregando...
        </div>
      </div>

      <!-- M√©tricas Principais -->
      <div class="grid grid-3 mb-4">
        <div class="card text-center" style="background: var(--gradient-success);">
          <h3 style="color: var(--color-success);">üë• Total de Alunos</h3>
          <div id="totalAlunos" style="font-size: 3rem; font-weight: bold; color: var(--color-success);">-</div>
          <p class="text-muted">que fizeram o quiz</p>
        </div>
        <div class="card text-center" style="background: var(--gradient-primary);">
          <h3 style="color: var(--color-primary);">üìä M√©dia Geral</h3>
          <div id="mediaGeral" style="font-size: 3rem; font-weight: bold; color: var(--color-primary);">-</div>
          <p class="text-muted">de aproveitamento</p>
        </div>
        <div class="card text-center" style="background: var(--gradient-warning);">
          <h3 style="color: var(--color-warning);">‚úÖ Taxa de Aprova√ß√£o</h3>
          <div id="taxaAprovacao" style="font-size: 3rem; font-weight: bold; color: var(--color-warning);">-</div>
          <p class="text-muted">acima de 70%</p>
        </div>
      </div>

      <!-- Tabela de Resultados -->
      <div class="card">
        <h3 class="mb-4">üìã Resultados Detalhados</h3>
        <div style="overflow-x: auto;">
          <table class="table" id="tabelaResultados">
            <thead>
              <tr>
                <th>#</th>
                <th>üë§ Nome</th>
                <th>‚úÖ Acertos</th>
                <th>üìä %</th>
                <th>‚è∞ Data/Hora</th>
                <th>üéØ Status</th>
                <th>üìà Detalhes</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

      <!-- An√°lise por Quest√£o -->
      <div class="card">
        <h3 class="mb-4">üìù An√°lise por Quest√£o</h3>
        <div id="analiseQuestoes"></div>
      </div>

      <!-- An√°lise por Descritor -->
      <div class="card">
        <h3 class="mb-4">üè∑Ô∏è An√°lise por Descritores</h3>
        <div id="analiseDescritores"></div>
      </div>
    </div>
  </div>

  <script>
    // ===== CONFIGURA√á√ÉO E DADOS =====
    
    // Quest√µes do Quiz (exemplo - pode ser personalizado)
    let QUESTOES = [
      {
        id: 1,
        texto: "Qual √© a velocidade da luz no v√°cuo?",
        opcoes: [
          "300.000 km/s",
          "299.792.458 m/s", 
          "3 √ó 10‚Å∏ m/s",
          "Todas as alternativas est√£o corretas"
        ],
        correta: 3,
        descritor: "D1 - Constantes f√≠sicas fundamentais",
        competencia: "Compreender fen√¥menos f√≠sicos",
        dificuldade: "F√°cil",
        tempo_estimado: 30
      },
      {
        id: 2,
        texto: "O que caracteriza o movimento retil√≠neo uniforme?",
        opcoes: [
          "Velocidade constante e acelera√ß√£o zero",
          "Velocidade vari√°vel e acelera√ß√£o constante",
          "Velocidade zero e acelera√ß√£o constante",
          "Velocidade e acelera√ß√£o vari√°veis"
        ],
        correta: 0,
        descritor: "D2 - Cinem√°tica b√°sica",
        competencia: "Analisar movimentos",
        dificuldade: "M√©dio",
        tempo_estimado: 45
      },
      {
        id: 3,
        texto: "Segundo a Lei de Ohm, a resist√™ncia el√©trica √©:",
        opcoes: [
          "R = V √ó I",
          "R = V / I",
          "R = I / V", 
          "R = V + I"
        ],
        correta: 1,
        descritor: "D3 - Eletricidade b√°sica",
        competencia: "Aplicar leis f√≠sicas",
        dificuldade: "F√°cil",
        tempo_estimado: 30
      },
      {
        id: 4,
        texto: "A energia cin√©tica de um objeto √© dada por:",
        opcoes: [
          "Ec = m √ó v",
          "Ec = ¬Ω √ó m √ó v",
          "Ec = ¬Ω √ó m √ó v¬≤",
          "Ec = m √ó v¬≤"
        ],
        correta: 2,
        descritor: "D4 - Energia mec√¢nica",
        competencia: "Aplicar conceitos energ√©ticos",
        dificuldade: "M√©dio",
        tempo_estimado: 40
      },
      {
        id: 5,
        texto: "O princ√≠pio da conserva√ß√£o da energia afirma que:",
        opcoes: [
          "A energia pode ser criada mas n√£o destru√≠da",
          "A energia pode ser destru√≠da mas n√£o criada",
          "A energia n√£o pode ser criada nem destru√≠da, apenas transformada",
          "A energia sempre aumenta em um sistema fechado"
        ],
        correta: 2,
        descritor: "D5 - Conserva√ß√£o de energia",
        competencia: "Compreender princ√≠pios fundamentais",
        dificuldade: "M√©dio",
        tempo_estimado: 50
      }
    ];

    // Estado do aplicativo
    let estadoApp = {
      telaAtual: 'config',
      questaoAtual: 0,
      respostas: [],
      nomeAluno: '',
      inicioQuiz: null,
      fimQuiz: null,
      githubConfig: {
        user: '',
        repo: '',
        token: '',
        configured: false
      },
      resultados: [],
      modoLocal: false
    };

    // Utilit√°rios
    const $ = (id) => document.getElementById(id);
    const $$ = (selector) => document.querySelectorAll(selector);
    
    const escapeHTML = (str) => {
      return String(str).replace(/[&<>"']/g, (match) => {
        const escape = {
          '&': '&amp;',
          '<': '&lt;',
          '>': '&gt;',
          '"': '&quot;',
          "'": '&#39;'
        };
        return escape[match];
      });
    };

    const formatarTempo = (segundos) => {
      const mins = Math.floor(segundos / 60);
      const secs = segundos % 60;
      return `${mins}:${secs.toString().padStart(2, '0')}`;
    };

    const gerarId = () => {
      return Date.now().toString(36) + Math.random().toString(36).substr(2);
    };

    const formatarData = (timestamp) => {
      return new Date(timestamp).toLocaleString('pt-BR');
    };

    // ===== GERENCIAMENTO DE TELAS =====
    
    const mostrarTela = (tela) => {
      // Esconder todas as telas
      ['config', 'home', 'quiz', 'resultado', 'dashboard'].forEach(id => {
        const elemento = $(id);
        if (elemento) {
          elemento.classList.add('hidden');
        }
      });
      
      // Mostrar tela solicitada
      const telaElemento = $(tela);
      if (telaElemento) {
        telaElemento.classList.remove('hidden');
        telaElemento.classList.add('fade-in');
        estadoApp.telaAtual = tela;
      }
    };

    // ===== INTEGRA√á√ÉO GITHUB =====
    
    const configurarGitHub = () => {
      const user = $('githubUser').value.trim();
      const repo = $('githubRepo').value.trim();
      const token = $('githubToken').value.trim();
      
      if (!user || !repo) {
        alert('Por favor, preencha usu√°rio e reposit√≥rio GitHub.');
        return;
      }
      
      estadoApp.githubConfig = {
        user,
        repo,
        token,
        configured: true
      };
      
      // Salvar configura√ß√£o localmente
      localStorage.setItem('githubConfig', JSON.stringify(estadoApp.githubConfig));
      
      mostrarTela('home');
      inicializarHome();
    };

    const usarModoLocal = () => {
      estadoApp.modoLocal = true;
      estadoApp.githubConfig.configured = false;
      mostrarTela('home');
      inicializarHome();
    };

    const verificarStatusGitHub = async () => {
      if (estadoApp.modoLocal) {
        $('statusGitHub').innerHTML = '<span class="status-offline">üíª</span> Modo Local';
        $('connectionStatus').innerHTML = '<span class="status-offline">üíª Modo Local</span>';
        return;
      }
      
      if (!estadoApp.githubConfig.configured) {
        $('statusGitHub').innerHTML = '<span class="status-offline">‚ùå</span> N√£o Configurado';
        $('connectionStatus').innerHTML = '<span class="status-offline">‚ùå N√£o Configurado</span>';
        return;
      }
      
      try {
        const response = await fetch(`https://api.github.com/repos/${estadoApp.githubConfig.user}/${estadoApp.githubConfig.repo}`);
        
        if (response.ok) {
          $('statusGitHub').innerHTML = '<span class="status-online">‚úÖ</span> Conectado';
          $('connectionStatus').innerHTML = '<span class="status-online">‚úÖ Conectado</span>';
        } else {
          $('statusGitHub').innerHTML = '<span class="status-offline">‚ùå</span> Reposit√≥rio n√£o encontrado';
          $('connectionStatus').innerHTML = '<span class="status-offline">‚ùå Reposit√≥rio n√£o encontrado</span>';
        }
      } catch (error) {
        $('statusGitHub').innerHTML = '<span class="status-offline">‚ùå</span> Erro de conex√£o';
        $('connectionStatus').innerHTML = '<span class="status-offline">‚ùå Erro de conex√£o</span>';
      }
    };

    const salvarResultadoGitHub = async (resultado) => {
      if (estadoApp.modoLocal || !estadoApp.githubConfig.configured || !estadoApp.githubConfig.token) {
        // Salvar localmente
        salvarResultadoLocal(resultado);
        return;
      }
      
      try {
        const fileName = `resultado-${Date.now()}-${resultado.nome.replace(/[^a-zA-Z0-9]/g, '-')}.json`;
        const content = btoa(JSON.stringify(resultado, null, 2));
        
        const response = await fetch(`https://api.github.com/repos/${estadoApp.githubConfig.user}/${estadoApp.githubConfig.repo}/contents/resultados/${fileName}`, {
          method: 'PUT',
          headers: {
            'Authorization': `token ${estadoApp.githubConfig.token}`,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            message: `Adicionar resultado: ${resultado.nome}`,
            content: content
          })
        });
        
        if (response.ok) {
          $('saveStatus').innerHTML = '<div style="color: var(--color-success);">‚úÖ Resultado salvo no GitHub com sucesso!</div>';
        } else {
          throw new Error('Erro ao salvar no GitHub');
        }
      } catch (error) {
        console.error('Erro ao salvar no GitHub:', error);
        $('saveStatus').innerHTML = '<div style="color: var(--color-warning);">‚ö†Ô∏è Erro no GitHub, salvando localmente...</div>';
        salvarResultadoLocal(resultado);
      }
    };

    const salvarResultadoLocal = (resultado) => {
      const resultados = JSON.parse(localStorage.getItem('quizResultados') || '[]');
      resultados.push(resultado);
      localStorage.setItem('quizResultados', JSON.stringify(resultados));
      $('saveStatus').innerHTML = '<div style="color: var(--color-success);">‚úÖ Resultado salvo localmente!</div>';
    };

    const carregarResultados = async () => {
      if (estadoApp.modoLocal || !estadoApp.githubConfig.configured) {
        // Carregar resultados locais
        const resultados = JSON.parse(localStorage.getItem('quizResultados') || '[]');
        estadoApp.resultados = resultados;
        return resultados;
      }
      
      try {
        const response = await fetch(`https://api.github.com/repos/${estadoApp.githubConfig.user}/${estadoApp.githubConfig.repo}/contents/resultados`);
        
        if (!response.ok) {
          throw new Error('Pasta resultados n√£o encontrada');
        }
        
        const files = await response.json();
        const resultados = [];
        
        for (const file of files) {
          if (file.name.endsWith('.json')) {
            try {
              const fileResponse = await fetch(file.download_url);
              const resultado = await fileResponse.json();
              resultados.push(resultado);
            } catch (error) {
              console.error('Erro ao carregar arquivo:', file.name, error);
            }
          }
        }
        
        estadoApp.resultados = resultados;
        return resultados;
      } catch (error) {
        console.error('Erro ao carregar resultados do GitHub:', error);
        // Fallback para resultados locais
        const resultados = JSON.parse(localStorage.getItem('quizResultados') || '[]');
        estadoApp.resultados = resultados;
        return resultados;
      }
    };

    // ===== FUNCIONALIDADES DE QR CODE =====
    
    const gerarQRCode = (elementoImg, texto, opcoes = {}) => {
      if (!elementoImg) return;
      
      try {
        const size = opcoes.size || 200;
        const color = opcoes.color || '3b82f6';
        const bgcolor = opcoes.bgcolor || 'ffffff';
        
        const url = `https://api.qrserver.com/v1/create-qr-code/?size=${size}x${size}&data=${encodeURIComponent(texto)}&color=${color}&bgcolor=${bgcolor}`;
        
        elementoImg.src = url;
        elementoImg.alt = 'QR Code';
        elementoImg.style.display = 'block';
        
        console.log('QR Code gerado com sucesso!');
      } catch (error) {
        console.error('Erro ao gerar QR Code:', error);
        elementoImg.style.display = 'none';
      }
    };

    const atualizarQRLink = () => {
      const url = window.location.href;
      gerarQRCode($('qrImage'), url, {
        size: 180,
        color: '3b82f6'
      });
    };

    // ===== FUNCIONALIDADES DO QUIZ =====
    
    const iniciarQuiz = () => {
      const nome = $('alunoNome').value.trim();
      if (!nome) {
        alert('Por favor, digite seu nome para continuar.');
        $('alunoNome').focus();
        return;
      }
      
      estadoApp.nomeAluno = nome;
      estadoApp.questaoAtual = 0;
      estadoApp.respostas = [];
      estadoApp.inicioQuiz = new Date();
      
      mostrarTela('quiz');
      mostrarQuestao();
    };

    const mostrarQuestao = () => {
      const questao = QUESTOES[estadoApp.questaoAtual];
      if (!questao) {
        finalizarQuiz();
        return;
      }

      // Atualizar interface
      $('qid').textContent = estadoApp.questaoAtual + 1;
      $('qtotal').textContent = QUESTOES.length;
      $('qtext').textContent = questao.texto;
      
      // Atualizar barra de progresso
      const progresso = ((estadoApp.questaoAtual) / QUESTOES.length) * 100;
      $('prog').style.width = progresso + '%';
      $('progText').textContent = Math.round(progresso) + '%';
      
      // Gerar op√ß√µes
      const olist = $('olist');
      olist.innerHTML = '';
      
      questao.opcoes.forEach((opcao, index) => {
        const div = document.createElement('div');
        div.className = 'quiz-option slide-in';
        div.style.animationDelay = (index * 0.1) + 's';
        div.innerHTML = `
          <div style="display: flex; align-items: center; gap: 1rem;">
            <div style="width: 32px; height: 32px; border-radius: 50%; background: var(--color-primary-light); color: var(--color-primary); display: flex; align-items: center; justify-content: center; font-weight: bold;">
              ${String.fromCharCode(65 + index)}
            </div>
            <div style="flex: 1;">${escapeHTML(opcao)}</div>
          </div>
        `;
        
        div.addEventListener('click', () => selecionarOpcao(index, div));
        olist.appendChild(div);
      });
    };

    const selecionarOpcao = (indice, elemento) => {
      // Remover sele√ß√£o anterior
      $$('.quiz-option').forEach(opt => {
        opt.classList.remove('selected');
      });
      
      // Selecionar nova op√ß√£o
      elemento.classList.add('selected');
      
      // Salvar resposta
      estadoApp.respostas[estadoApp.questaoAtual] = {
        questao: estadoApp.questaoAtual,
        resposta: indice,
        tempo: new Date() - estadoApp.inicioQuiz,
        correta: indice === QUESTOES[estadoApp.questaoAtual].correta
      };
      
      // Auto-avan√ßar ap√≥s 1 segundo
      setTimeout(() => {
        proximaQuestao();
      }, 1000);
    };

    const proximaQuestao = () => {
      estadoApp.questaoAtual++;
      
      if (estadoApp.questaoAtual >= QUESTOES.length) {
        finalizarQuiz();
      } else {
        mostrarQuestao();
      }
    };

    const finalizarQuiz = () => {
      estadoApp.fimQuiz = new Date();
      mostrarTela('resultado');
      gerarResultado();
      salvarResultadoAutomatico();
    };

    // ===== GERA√á√ÉO DE RESULTADOS =====
    
    const gerarResultado = () => {
      const acertos = estadoApp.respostas.filter(r => r.correta).length;
      const total = QUESTOES.length;
      const percentual = Math.round((acertos / total) * 100);
      const tempoTotal = Math.round((estadoApp.fimQuiz - estadoApp.inicioQuiz) / 1000);
      
      // Resumo principal
      const resumo = $('resumo');
      resumo.innerHTML = `
        <div class="grid grid-3 mb-4">
          <div class="card text-center" style="background: var(--color-success-light);">
            <h3 style="color: var(--color-success); margin-bottom: 0.5rem;">‚úÖ Acertos</h3>
            <div style="font-size: 2.5rem; font-weight: bold; color: var(--color-success);">${acertos}</div>
            <p class="text-muted">de ${total} quest√µes</p>
          </div>
          <div class="card text-center" style="background: var(--color-primary-light);">
            <h3 style="color: var(--color-primary); margin-bottom: 0.5rem;">üìä Percentual</h3>
            <div style="font-size: 2.5rem; font-weight: bold; color: var(--color-primary);">${percentual}%</div>
            <p class="text-muted">de aproveitamento</p>
          </div>
          <div class="card text-center" style="background: var(--color-warning-light);">
            <h3 style="color: var(--color-warning); margin-bottom: 0.5rem;">‚è±Ô∏è Tempo</h3>
            <div style="font-size: 2.5rem; font-weight: bold; color: var(--color-warning);">${formatarTempo(tempoTotal)}</div>
            <p class="text-muted">tempo total</p>
          </div>
        </div>
        
        <div class="card" style="background: ${percentual >= 70 ? 'var(--color-success-light)' : 'var(--color-warning-light)'};">
          <h3 style="color: ${percentual >= 70 ? 'var(--color-success)' : 'var(--color-warning)'};">
            ${percentual >= 70 ? 'üéâ Parab√©ns!' : 'üìö Continue estudando!'}
          </h3>
          <p>
            ${percentual >= 70 
              ? `Excelente desempenho! Voc√™ demonstrou bom dom√≠nio do conte√∫do.`
              : `Voc√™ pode melhorar! Revise os t√≥picos e tente novamente.`
            }
          </p>
        </div>
      `;
    };

    const salvarResultadoAutomatico = () => {
      const acertos = estadoApp.respostas.filter(r => r.correta).length;
      const total = QUESTOES.length;
      const percentual = Math.round((acertos / total) * 100);
      
      const resultado = {
        id: gerarId(),
        nome: estadoApp.nomeAluno,
        score: acertos,
        total: total,
        percentual: percentual,
        tempo_total: Math.round((estadoApp.fimQuiz - estadoApp.inicioQuiz) / 1000),
        timestamp: estadoApp.fimQuiz.toISOString(),
        respostas: estadoApp.respostas,
        questoes: QUESTOES,
        analise_descritores: gerarAnaliseDescritores()
      };
      
      salvarResultadoGitHub(resultado);
    };

    const gerarAnaliseDescritores = () => {
      const analise = {};
      estadoApp.respostas.forEach((resposta, index) => {
        const questao = QUESTOES[index];
        const descritor = questao.descritor;
        
        if (!analise[descritor]) {
          analise[descritor] = {
            total: 0,
            acertos: 0,
            competencia: questao.competencia,
            dificuldade: questao.dificuldade
          };
        }
        
        analise[descritor].total++;
        if (resposta.correta) {
          analise[descritor].acertos++;
        }
      });
      
      return analise;
    };

    // ===== DASHBOARD DO PROFESSOR =====
    
    const abrirDashboard = async () => {
      mostrarTela('dashboard');
      $('lastUpdate').textContent = 'üïí Carregando dados...';
      
      await carregarResultados();
      atualizarDashboard();
    };

    const atualizarDashboard = () => {
      const resultados = estadoApp.resultados;
      
      if (resultados.length === 0) {
        $('totalAlunos').textContent = '0';
        $('mediaGeral').textContent = '-';
        $('taxaAprovacao').textContent = '-';
        $('lastUpdate').textContent = 'üïí Nenhum resultado encontrado';
        return;
      }
      
      // M√©tricas principais
      const totalAlunos = resultados.length;
      const mediaGeral = Math.round(resultados.reduce((acc, r) => acc + r.percentual, 0) / totalAlunos);
      const aprovados = resultados.filter(r => r.percentual >= 70).length;
      const taxaAprovacao = Math.round((aprovados / totalAlunos) * 100);
      
      $('totalAlunos').textContent = totalAlunos;
      $('mediaGeral').textContent = mediaGeral + '%';
      $('taxaAprovacao').textContent = taxaAprovacao + '%';
      $('resultadosCount').textContent = totalAlunos;
      
      // Atualizar tabela
      atualizarTabelaResultados(resultados);
      
      // An√°lises
      gerarAnaliseQuestoes(resultados);
      gerarAnaliseDescritoresDashboard(resultados);
      
      $('lastUpdate').textContent = `üïí √öltima atualiza√ß√£o: ${formatarData(Date.now())}`;
    };

    const atualizarTabelaResultados = (resultados) => {
      const tbody = $('tabelaResultados').querySelector('tbody');
      tbody.innerHTML = '';
      
      resultados.sort((a, b) => b.percentual - a.percentual).forEach((resultado, index) => {
        const tr = document.createElement('tr');
        const status = resultado.percentual >= 70 ? 
          '<span style="color: var(--color-success);">‚úÖ Aprovado</span>' : 
          '<span style="color: var(--color-warning);">üìö Recupera√ß√£o</span>';
        
        tr.innerHTML = `
          <td>${index + 1}</td>
          <td>${escapeHTML(resultado.nome)}</td>
          <td>${resultado.score}/${resultado.total}</td>
          <td><strong>${resultado.percentual}%</strong></td>
          <td>${formatarData(resultado.timestamp)}</td>
          <td>${status}</td>
          <td>
            <button class="btn btn-sm btn-secondary" onclick="verDetalhes('${resultado.id}')">
              üëÅÔ∏è Ver
            </button>
          </td>
        `;
        
        tbody.appendChild(tr);
      });
    };

    const gerarAnaliseQuestoes = (resultados) => {
      if (resultados.length === 0) return;
      
      const analise = {};
      
      // Inicializar an√°lise
      QUESTOES.forEach(questao => {
        analise[questao.id] = {
          texto: questao.texto,
          descritor: questao.descritor,
          total_respostas: 0,
          acertos: 0,
          percentual_acerto: 0
        };
      });
      
      // Processar resultados
      resultados.forEach(resultado => {
        resultado.respostas.forEach((resposta, index) => {
          const questaoId = QUESTOES[index].id;
          analise[questaoId].total_respostas++;
          if (resposta.correta) {
            analise[questaoId].acertos++;
          }
        });
      });
      
      // Calcular percentuais
      Object.values(analise).forEach(item => {
        if (item.total_respostas > 0) {
          item.percentual_acerto = Math.round((item.acertos / item.total_respostas) * 100);
        }
      });
      
      // Renderizar
      const container = $('analiseQuestoes');
      let html = '';
      
      Object.values(analise).forEach(item => {
        const cor = item.percentual_acerto >= 70 ? 'var(--color-success)' : 
                   item.percentual_acerto >= 50 ? 'var(--color-warning)' : 'var(--color-error)';
        
        html += `
          <div class="mb-3 p-3" style="background: var(--bg-secondary); border-radius: 8px; border-left: 4px solid ${cor};">
            <div style="display: flex; justify-content: space-between; align-items: center;">
              <div style="flex: 1;">
                <div style="font-weight: 500;">${item.texto.substring(0, 80)}...</div>
                <div style="font-size: 0.875rem; color: var(--text-muted);">${item.descritor}</div>
              </div>
              <div style="text-align: right;">
                <div style="font-size: 1.5rem; font-weight: bold; color: ${cor};">${item.percentual_acerto}%</div>
                <div style="font-size: 0.75rem; color: var(--text-muted);">${item.acertos}/${item.total_respostas} acertos</div>
              </div>
            </div>
          </div>
        `;
      });
      
      container.innerHTML = html;
    };

    const gerarAnaliseDescritoresDashboard = (resultados) => {
      if (resultados.length === 0) return;
      
      const analise = {};
      
      resultados.forEach(resultado => {
        if (resultado.analise_descritores) {
          Object.entries(resultado.analise_descritores).forEach(([descritor, dados]) => {
            if (!analise[descritor]) {
              analise[descritor] = {
                competencia: dados.competencia,
                total_questoes: 0,
                total_acertos: 0,
                total_alunos: 0
              };
            }
            
            analise[descritor].total_questoes += dados.total;
            analise[descritor].total_acertos += dados.acertos;
            analise[descritor].total_alunos++;
          });
        }
      });
      
      const container = $('analiseDescritores');
      let html = '';
      
      Object.entries(analise).forEach(([descritor, dados]) => {
        const percentual = Math.round((dados.total_acertos / dados.total_questoes) * 100);
        const cor = percentual >= 70 ? 'var(--color-success)' : 
                   percentual >= 50 ? 'var(--color-warning)' : 'var(--color-error)';
        
        html += `
          <div class="mb-3 p-3" style="background: var(--bg-secondary); border-radius: 8px; border-left: 4px solid ${cor};">
            <div style="display: flex; justify-content: space-between; align-items: center;">
              <div style="flex: 1;">
                <div style="font-weight: 500;">${descritor}</div>
                <div style="font-size: 0.875rem; color: var(--text-muted);">${dados.competencia}</div>
                <div style="font-size: 0.75rem; color: var(--text-muted);">${dados.total_alunos} alunos avaliados</div>
              </div>
              <div style="text-align: right;">
                <div style="font-size: 1.5rem; font-weight: bold; color: ${cor};">${percentual}%</div>
                <div style="font-size: 0.75rem; color: var(--text-muted);">${dados.total_acertos}/${dados.total_questoes} acertos</div>
              </div>
            </div>
          </div>
        `;
      });
      
      container.innerHTML = html;
    };

    // ===== FUNCIONALIDADES AUXILIARES =====
    
    const copiarLink = () => {
      navigator.clipboard.writeText(window.location.href).then(() => {
        alert('Link copiado para a √°rea de transfer√™ncia!');
      }).catch(() => {
        alert('Erro ao copiar link.');
      });
    };

    const exportarTodosDados = () => {
      const dados = {
        configuracao: estadoApp.githubConfig,
        questoes: QUESTOES,
        resultados: estadoApp.resultados,
        exportado_em: new Date().toISOString()
      };
      
      const blob = new Blob([JSON.stringify(dados, null, 2)], { type: 'application/json' });
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = `quiz-dados-completos-${new Date().toISOString().split('T')[0]}.json`;
      link.click();
    };

    const inicializarHome = () => {
      verificarStatusGitHub();
      atualizarQRLink();
      
      // Carregar contagem de resultados
      carregarResultados().then(resultados => {
        $('resultadosCount').textContent = resultados.length;
      });
    };

    // ===== EVENT LISTENERS =====
    
    const inicializarEventListeners = () => {
      // Configura√ß√£o
      $('btnConfigurar').addEventListener('click', configurarGitHub);
      $('btnModoLocal').addEventListener('click', usarModoLocal);
      
      // Bot√µes principais
      $('btnIniciar').addEventListener('click', iniciarQuiz);
      $('btnSair').addEventListener('click', () => mostrarTela('home'));
      $('btnRefazer').addEventListener('click', () => {
        mostrarTela('home');
        $('alunoNome').value = '';
      });
      $('btnVoltar').addEventListener('click', () => mostrarTela('home'));
      
      // QR Code
      $('btnQrLink').addEventListener('click', atualizarQRLink);
      $('btnCopiarLink').addEventListener('click', copiarLink);
      
      // Dashboard
      $('btnDashboard').addEventListener('click', abrirDashboard);
      $('btnFecharDashboard').addEventListener('click', () => mostrarTela('home'));
      $('btnAtualizarDados').addEventListener('click', atualizarDashboard);
      
      // Configura√ß√µes
      $('btnConfigurarRepo').addEventListener('click', () => mostrarTela('config'));
      $('btnExportarDados').addEventListener('click', exportarTodosDados);
      
      // Teclas de atalho
      document.addEventListener('keydown', (e) => {
        if (estadoApp.telaAtual === 'quiz') {
          const num = parseInt(e.key);
          if (num >= 1 && num <= 4) {
            const opcoes = $$('.quiz-option');
            if (opcoes[num - 1]) {
              opcoes[num - 1].click();
            }
          }
        }
      });
    };

    // ===== INICIALIZA√á√ÉO =====
    
    const inicializar = () => {
      console.log('üéì Quiz Educacional - GitHub Integrado - Inicializando...');
      
      // Carregar configura√ß√£o salva
      const configSalva = localStorage.getItem('githubConfig');
      if (configSalva) {
        try {
          estadoApp.githubConfig = JSON.parse(configSalva);
          if (estadoApp.githubConfig.configured) {
            mostrarTela('home');
            inicializarHome();
          }
        } catch (error) {
          console.error('Erro ao carregar configura√ß√£o:', error);
        }
      }
      
      // Configurar event listeners
      inicializarEventListeners();
      
      console.log('‚úÖ Inicializa√ß√£o conclu√≠da!');
    };

    // Aguardar carregamento completo da p√°gina
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', inicializar);
    } else {
      inicializar();
    }

    console.log('üöÄ Quiz Educacional - GitHub Integrado carregado!');
  </script>
</body>
</html>

